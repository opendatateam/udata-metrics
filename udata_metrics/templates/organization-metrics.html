{% from theme('macros/metrics.html') import metrics %}

<section class="fr-pb-15v vuejs">
    <div class="fr-grid-row fr-grid-row--gutters fr-grid-row--gutters">
        <div class="fr-col">
            <h1 class="fr-h3">{{ _("General statistics") }}</h1>
        </div>
        <div class="fr-col-auto">
            <a class="fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-download-line fr-btn--icon-left"
               href="{{metric_csv_url}}">
                {{ _("Download metrics as CSV") }}
            </a>
        </div>
    </div>
    <div class="fr-grid-row fr-grid-row--gutters">
        {{metrics(_("Datasets"), org.metrics.datasets, dataset_metrics, type="bar")}}
        {{metrics(_("Reuses"), org.metrics.reuses, reuse_metrics, type="bar")}}
    </div>
    <h2 class="subtitle subtitle--uppercase fr-pt-10v">{{ _('Datasets statistics') }}</h2>
    <div class="fr-grid-row fr-grid-row--gutters">
        {% if visit_dataset %}
            {{metrics(_("Views"), visit_dataset.values()|sum, visit_dataset, type="line")}}
        {% endif %}
        {% if visit_resource %}
            {{metrics(_("Downloads"), visit_resource.values()|sum, visit_resource, type="line")}}
        {% endif %}
        {{metrics(_("Reuses on datasets"), dataset_reuse_metrics.values()|sum, dataset_reuse_metrics, type="line")}}
        {{metrics(_("Followers"), dataset_follower_metrics.values()|sum, dataset_follower_metrics, type="bar")}}
    </div>
    <h2 class="subtitle subtitle--uppercase fr-pt-10v">{{ _('Reuses statistics') }}</h2>
    <div class="fr-grid-row fr-grid-row--gutters">
        {% if visit_reuse %}
            {{metrics(_("Views"), visit_reuse.values()|sum, visit_reuse, type="line")}}
        {% endif %}
        {% if outlink_metrics %}
            {{metrics(_("Reuses opening"), outlink_metrics.values()|sum, outlink_metrics, type="line")}}
        {% endif %}
        {{metrics(_("Followers"), reuse_follower_metrics.values()|sum, reuse_follower_metrics, type="bar")}}
    </div>
</section>
